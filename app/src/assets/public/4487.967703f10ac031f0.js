"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[4487],{4487:(x,h,r)=>{r.r(h),r.d(h,{HttpLoaderFactory:()=>d,Tab3PageModule:()=>S});var n=r(8974),b=r(1470),u=r(177),c=r(9417),t=r(6996),_=r(9884),o=r(9664);const f=["rtklib_rover_snr_Canvas"],v=["rtklib_base_snr_Canvas"],p=["rtklib_skyplot_Canvas"],k=["ublox_rover_snr_Canvas"],y=["ublox_skyplot_Canvas"];let m=(()=>{class l{constructor(s,a){this.dataService=s,this.translate=a,this.hide_rtklib_chart=!0,this.hide_ublox_chart=!1,this.r1=[],this.r1_name=[],this.r1_snr=[],this.sat1color=[],this.r2=[],this.r2_name=[],this.r2_snr=[],this.sat2color=[],this.name_sky1=[],this.atz_sky1=[],this.elv_sky1=[],this.sky1color=[],this.ub_sat=[],this.ub_snr=[],this.ub_atz=[],this.ub_elv=[],this.sky2color=[],this.request=!1,a.setDefaultLang("en")}ngOnInit(){console.log("Satellite Page"),this.createChart(),$(".connection1").css("color","gray");let s=!0;setInterval(()=>{this.dataService.connected&&!this.request?(this.request=!0,$(".connection1").css("color","orange"),$.isEmptyObject(this.dataService.info)||($(".connection1").css("color","lightgreen"),this.dataInfo=this.dataService.info,s=this.dataInfo.base,this.rtk_engine=this.dataInfo.rtk_engine,"rtklib"==this.rtk_engine?(this.hide_rtklib_chart=!1,this.hide_ublox_chart=!0):"ublox"==this.rtk_engine&&(this.hide_rtklib_chart=!0,this.hide_ublox_chart=!1)),this.request=!1):this.clearChart()},2e3)}ionViewDidEnter(){this.dataService.blue_conneted?(this.dataService.pauseStatus=!0,this.satSub=this.dataService.satObservable?.subscribe(s=>{$.isEmptyObject(s)||(this.dataSatellite=s,this.updateChart())}),this.dataService.blueRequestaSatellite(),this.timer_sat=setInterval(()=>{this.dataService.blueRequestaSatellite()},1e3)):this.dataService.wifi_connected&&(this.timer_sat=setInterval(()=>{this.dataService.getSatellite().then(s=>{$.isEmptyObject(s)||(this.dataSatellite=s,this.updateChart())},s=>{console.log(s)})},5e3))}ionViewDidLeave(){clearInterval(this.timer_sat),this.dataService.blue_conneted&&(this.dataService.pauseStatus=!1,this.satSub?.unsubscribe(),this.dataService.bluetoothClearCommand())}createChart(){this.rtklib_rover_snr=new Chart(this.rtklib_rover_snr_Canvas.nativeElement,{type:"bar",data:{labels:[],datasets:[{label:"Rover SNR",data:[],fill:!1,backgroundColor:[],borderColor:[],borderWidth:1}]},options:{events:[],scales:{yAxes:[{ticks:{beginAtZero:!0}}]}}}),this.rtklib_base_snr=new Chart(this.rtklib_base_snr_Canvas.nativeElement,{type:"bar",data:{labels:[],datasets:[{label:"Base SNR",data:[],fill:!1,backgroundColor:[],borderColor:[],borderWidth:1}]},options:{events:[],scales:{yAxes:[{ticks:{beginAtZero:!0}}]}}}),this.rtklib_skyplot=new Chart(this.rtklib_skyplot_Canvas.nativeElement,{type:"skyPlot",data:{datasets:[{satname:[],altazimuth:[],elevation:[],satcolor:[]}]},options:{title:{display:!0,text:"Rover Sky View"},maintainAspectRatio:!1}}),this.ublox_rover_snr=new Chart(this.ublox_rover_snr_Canvas.nativeElement,{type:"bar",data:{labels:[],datasets:[{label:"Rover SNR",data:[],fill:!1,backgroundColor:"LightGreen",borderColor:[],borderWidth:1}]},options:{events:[],scales:{yAxes:[{ticks:{beginAtZero:!0}}]}}}),this.ublox_skyplot=new Chart(this.ublox_skyplot_Canvas.nativeElement,{type:"skyPlot",data:{datasets:[{satname:[],altazimuth:[],elevation:[],satcolor:[]}]},options:{title:{display:!0,text:"Rover Sky View"},maintainAspectRatio:!1}})}updateChart(){if(!($.isEmptyObject(this.dataInfo)&&this.dataInfo.base||"rtklib"==this.rtk_engine)&&"ublox"==this.rtk_engine){if(this.hide_rtklib_chart=!0,this.hide_ublox_chart=!1,typeof this.dataSatellite.satellites<"u")this.ub_sat=this.dataSatellite.satellites.map(e=>e.prn),this.ub_snr=this.dataSatellite.satellites.map(e=>e.SNR),(s=this.dataSatellite.satellites.length)>0&&(this.sky2color=new Array(s)),this.ub_atz=this.dataSatellite.satellites.map(e=>e.atz),this.ub_elv=this.dataSatellite.satellites.map(e=>e.elev);else if(typeof this.dataSatellite.sat2<"u"){var s;this.ub_sat=this.dataSatellite.sat2.map(i=>i[0]),this.ub_snr=this.dataSatellite.sat2.map(i=>i[1]),(s=this.dataSatellite.sat2.length)>0&&(this.sky2color=new Array(s)),this.ub_elv=this.dataSatellite.sat2.map(i=>i[2]),this.ub_atz=this.dataSatellite.sat2.map(i=>i[3])}if(this.ub_sat.length>0){for(var a in this.ublox_rover_snr.data.labels=this.ub_sat,this.ublox_rover_snr.data.datasets[0].data=this.ub_snr,this.ublox_rover_snr.update(),this.ublox_skyplot.config.data.datasets[0].satname=this.ub_sat,this.ublox_skyplot.config.data.datasets[0].altazimuth=this.ub_atz,this.ublox_skyplot.config.data.datasets[0].elevation=this.ub_elv,this.ub_sat)this.sky2color[a]=this.ub_snr[a]>0?-1!==this.ub_sat[a].indexOf("G")?"#1a75ff":-1!==this.ub_sat[a].indexOf("R")?"#ff33ff":-1!==this.ub_sat[a].indexOf("C")?"#ff3300":-1!==this.ub_sat[a].indexOf("E")?"#ffff00":-1!==this.ub_sat[a].indexOf("J")?"#e6e6e6":-1!==this.ub_sat[a].indexOf("S")?"#eeab0fff":-1!==this.ub_sat[a].indexOf("I")?"#06f160ff":"#9d9b9bff":"lightgray";this.ublox_skyplot.config.data.datasets[0].satcolor=this.sky2color,this.ublox_skyplot.update()}}}sat_match_color(s){var a=this.dataSatellite.satellite.find(e=>e.SAT==s);return typeof a<"u"&&("OK"===a.L1||"OK"===a.L2)?"#ff80ff":"#e0e0eb"}clearChart(){this.ublox_rover_snr.data.labels=[],this.ublox_rover_snr.data.datasets[0].data=[],this.ublox_skyplot.config.data.datasets[0].satname=[],this.ublox_skyplot.config.data.datasets[0].altazimuth=[],this.ublox_skyplot.config.data.datasets[0].elevation=[],this.ublox_rover_snr.update(),this.ublox_skyplot.update(),this.rtklib_rover_snr.data.labels=[],this.rtklib_rover_snr.data.datasets[0].data=[],this.rtklib_base_snr.data.labels=[],this.rtklib_base_snr.data.datasets[0].data=[],this.rtklib_skyplot.config.data.datasets[0].satname=[],this.rtklib_skyplot.config.data.datasets[0].altazimuth=[],this.rtklib_skyplot.config.data.datasets[0].elevation=[],this.rtklib_rover_snr.update(),this.rtklib_base_snr.update(),this.rtklib_skyplot.update()}static{this.\u0275fac=function(a){return new(a||l)(t.rXU(_.f),t.rXU(o.c$))}}static{this.\u0275cmp=t.VBU({type:l,selectors:[["app-tab3"]],viewQuery:function(a,e){if(1&a&&(t.GBs(f,7),t.GBs(v,7),t.GBs(p,7),t.GBs(k,7),t.GBs(y,7)),2&a){let i;t.mGM(i=t.lsd())&&(e.rtklib_rover_snr_Canvas=i.first),t.mGM(i=t.lsd())&&(e.rtklib_base_snr_Canvas=i.first),t.mGM(i=t.lsd())&&(e.rtklib_skyplot_Canvas=i.first),t.mGM(i=t.lsd())&&(e.ublox_rover_snr_Canvas=i.first),t.mGM(i=t.lsd())&&(e.ublox_skyplot_Canvas=i.first)}},decls:24,vars:5,consts:[["color","darkblue"],[1,"mx-auto"],["name","radio-button-on","slot","end",1,"me-3","connection1"],[3,"hidden"],[1,"py-2","px-2"],["rtklib_rover_snr_Canvas",""],["rtklib_base_snr_Canvas",""],[1,"py-2","px-2",2,"height","350px"],["rtklib_skyplot_Canvas",""],["ublox_rover_snr_Canvas",""],["ublox_skyplot_Canvas",""]],template:function(a,e){1&a&&(t.j41(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-title",1),t.EFF(3),t.nI1(4,"translate"),t.k0s(),t.nrm(5,"ion-icon",2),t.k0s()(),t.j41(6,"ion-content")(7,"section",3)(8,"ion-card",4),t.nrm(9,"canvas",null,5),t.k0s(),t.j41(11,"ion-card",4),t.nrm(12,"canvas",null,6),t.k0s(),t.j41(14,"ion-card",7),t.nrm(15,"canvas",null,8),t.k0s()(),t.j41(17,"section",3)(18,"ion-card",4),t.nrm(19,"canvas",null,9),t.k0s(),t.j41(21,"ion-card",7),t.nrm(22,"canvas",null,10),t.k0s()()()),2&a&&(t.R7$(3),t.SpI(" ",t.bMT(4,3,"SATELLITE")," "),t.R7$(4),t.Y8G("hidden",e.hide_rtklib_chart),t.R7$(10),t.Y8G("hidden",e.hide_ublox_chart))},dependencies:[n.b_,n.W9,n.eU,n.iq,n.BC,n.ai,o.D9],styles:[".test[_ngcontent-%COMP%]{height:350px}.font-header[_ngcontent-%COMP%]{font-size:16px}.lightblue[_ngcontent-%COMP%]{color:#add8e6}"]})}}return l})();var g=r(1626),C=r(5635);function d(l){return new C.s(l,"./assets/i18n/",".json")}let S=(()=>{class l{static{this.\u0275fac=function(a){return new(a||l)}}static{this.\u0275mod=t.$C({type:l})}static{this.\u0275inj=t.G2t({imports:[n.bv,u.MD,c.YN,b.iI.forChild([{path:"",component:m}]),o.h.forChild({loader:{provide:o.Wr,useFactory:d,deps:[g.Qq]}})]})}}return l})()}}]);